# operation_check

# 功能背景

此代码项目用于对Linux设备的系统相关信息进行查询输出，可以作为自动化巡检的一个参考。

## 1.涉及到以下几项的查询操作

- 设备的OS信息、主机名、内核版本
- 操作系统登录用户、系统已运行时间、系统平均负载
- 内存和交换空间的使用情况、内存使用率前5的进程信息
- CPU使用情况, CPU使用率前5的进程信息
- 磁盘和Inode的使用情况

## 2.建议环境

```bash
python >= 3.6.12 版本
pip >= 18.1 版本
```
# 使用方式

## 1.运行演示

```python
'''将文件下载/复制/拉取倒服务器上，使用pip下载库，执行python3 Linux_check.py即可'''
pip3 install psutil && pip3 install distro

python3 Linux_check.py 
```

## 2.运行结果实例

```bash
root@sulibao-None:/home/sulibao/python# python3 Linux_check.py 

(myenv) root@sulibao-None:/home/sulibao/python/080601# cat system_monitor.log 
2025-08-06 12:06:47,914 - INFO - ==================================================
2025-08-06 12:06:47,914 - INFO - 系统信息报告 - 2025-08-06 12:06:47
2025-08-06 12:06:47,914 - INFO - ==================================================
2025-08-06 12:06:47,914 - INFO - 1. 操作系统信息
2025-08-06 12:06:47,934 - INFO - 成功获取到OS信息
2025-08-06 12:06:47,934 - INFO - 2. 登录用户信息
2025-08-06 12:06:47,934 - INFO - 成功获取登录用户信息
2025-08-06 12:06:47,934 - INFO - 3. 系统运行时间与平均负载
2025-08-06 12:06:47,934 - INFO - 成功获取系统运行时间
2025-08-06 12:06:47,935 - INFO - 成功获取系统平均负载
2025-08-06 12:06:47,935 - INFO - 4. 内存和交换空间信息
2025-08-06 12:06:47,935 - INFO - 成功获取内存和交换空间信息
2025-08-06 12:06:47,935 - INFO - 5. 内存使用率最高的5个进程
2025-08-06 12:06:47,993 - INFO - 成功获取内存使用率最高的5个进程
2025-08-06 12:06:47,993 - INFO - 6. CPU使用情况
2025-08-06 12:06:48,995 - INFO - 成功获取CPU信息
2025-08-06 12:06:48,995 - INFO - 7. CPU使用率最高的5个进程
2025-08-06 12:07:22,900 - INFO - 成功获取CPU使用率最高的5个进程
2025-08-06 12:07:22,900 - INFO - 8. 磁盘使用情况
2025-08-06 12:07:22,901 - INFO - 成功获取磁盘使用情况
2025-08-06 12:07:22,901 - INFO - 9. Inode使用情况
2025-08-06 12:07:22,908 - INFO - 成功获取Inode使用情况

==================================================
=============================================================================================================================
系统OS信息如下:

操作系统: Linux
主机名: sulibao-None
内核版本: 6.8.0-71-generic
发行版名称: Ubuntu
发行版版本: 24.04
机器类型: x86_64

=============================================================================================================================
当前系统登录用户如下:

用户 1:
  用户名: sulibao
  终端: pts/0
  主机: 192.168.2.2
  登录时间: 2025-08-06 12:04:16
用户 2:
  用户名: sulibao
  终端: pts/1
  主机: 192.168.2.2
  登录时间: 2025-08-06 12:04:22

=============================================================================================================================
系统运行相关信息如下:

启动时间: 2025-08-06 09:02:03
运行时间: 0天 3小时 4分钟 44秒

系统平均负载:
  1分钟负载: 0.12 (2.9%)
  5分钟负载: 0.07 (1.7%)
  15分钟负载: 0.02 (0.4%)

=============================================================================================================================
内存和交换空间使用情况如下:

物理内存:
  总计: 7.71 GB
  可用: 6.58 GB
  已使用: 862.20 MB (14.6%)
  空闲: 5.27 GB

交换空间:
  总计: 4.00 GB
  已使用: 0 B (0.0%)
  空闲: 4.00 GB
  从磁盘换入: 0 B
  换出到磁盘: 0 B

=============================================================================================================================
内存使用率最高的5个进程信息如下:

PID      username     mem_used_percent   mem_used        process_name   
-----------------------------------------------------------------------------------------------------------------------------
1998     gdm          2.61               205.91 MB       gnome-shell    
2469     1001         1.72               135.88 MB       minio          
1778     root         1.28               101.03 MB       journalctl     
2876     gdm          1.03               81.62 MB        mutter-x11-frames
2307     gdm          1.03               81.25 MB        Xwayland       

=============================================================================================================================
CPU使用情况如下:

物理核心数: 4
逻辑核心数: 4
总CPU使用率: 0.0%

各核心CPU使用率:
  核心 1: 0.0%
  核心 2: 0.0%
  核心 3: 6.4%
  核心 4: 2.7%

CPU频率:
  当前: 2496.01 MHz
  最小: 0.00 MHz
  最大: 0.00 MHz

=============================================================================================================================
CPU使用率最高的5个进程信息如下:

PID      username        cpu_used(%)     process_name        
-----------------------------------------------------------------------------------------------------------------------------
14205    root            14.60           python3             
797      root            0.40            vmtoolsd            
1762     root            0.20            containerd          
724      systemd-oom     0.10            systemd-oomd        
2420     root            0.10            containerd-shim-ru  

=============================================================================================================================
磁盘使用情况如下:

Device               Filesystem      Mounted on                Size            Used            Used_percent(%)      Free           
-----------------------------------------------------------------------------------------------------------------------------
/dev/sda2            ext4            /                         29.36 GB        17.41 GB        62.5                 10.43 GB       
/dev/loop1           squashfs        /snap/bare/5              128.00 KB       128.00 KB       100.0                0 B            
/dev/loop0           squashfs        /snap/core22/1981         74.00 MB        74.00 MB        100.0                0 B            
/dev/loop2           squashfs        /snap/core22/2045         74.00 MB        74.00 MB        100.0                0 B            
/dev/loop3           squashfs        /snap/firefox/6565        245.25 MB       245.25 MB       100.0                0 B            
/dev/loop4           squashfs        /snap/firefox/4848        271.25 MB       271.25 MB       100.0                0 B            
/dev/loop6           squashfs        /snap/firmware-upd        11.25 MB        11.25 MB        100.0                0 B            
/dev/loop5           squashfs        /snap/firmware-upd        10.75 MB        10.75 MB        100.0                0 B            
/dev/loop7           squashfs        /snap/gnome-42-220        497.00 MB       497.00 MB       100.0                0 B            
/dev/loop9           squashfs        /snap/snap-store/1        10.62 MB        10.62 MB        100.0                0 B            
/dev/loop11          squashfs        /snap/snapd/24792         49.38 MB        49.38 MB        100.0                0 B            
/dev/loop12          squashfs        /snap/snapd-deskto        640.00 KB       640.00 KB       100.0                0 B            
/dev/loop8           squashfs        /snap/gtk-common-t        91.75 MB        91.75 MB        100.0                0 B            
/dev/loop13          squashfs        /snap/snapd-deskto        640.00 KB       640.00 KB       100.0                0 B            
/dev/loop10          squashfs        /snap/snap-store/1        10.88 MB        10.88 MB        100.0                0 B            
/dev/sda2            ext4            /var/snap/firefox/        29.36 GB        17.41 GB        62.5                 10.43 GB       
/dev/loop14          squashfs        /snap/snapd/24505         51.00 MB        51.00 MB        100.0                0 B            
/dev/loop15          squashfs        /snap/gnome-42-220        516.12 MB       516.12 MB       100.0                0 B            
/dev/loop17          squashfs        /snap/thunderbird/        210.38 MB       210.38 MB       100.0                0 B            
/dev/loop16          squashfs        /snap/thunderbird/        210.00 MB       210.00 MB       100.0                0 B            

=============================================================================================================================
Inode使用情况如下:

Filesystem      Total_inodes    Used_inodes     Free_inodes     used_percent(%)      Mounted on          
-----------------------------------------------------------------------------------------------------------------------------
tmpfs           1010446         1317            1009129         1%                   /run                
/dev/sda2       1966080         292690          1673390         15%                  /                   
tmpfs           1010446         1               1010445         1%                   /dev/shm            
tmpfs           1010446         4               1010442         1%                   /run/lock           
tmpfs           202089          101             201988          1%                   /run/user/123       
overlay         1966080         292690          1673390         15%                  /data/docker_data/  
overlay         1966080         292690          1673390         15%                  /data/docker_data/  
tmpfs           202089          93              201996          1%                   /run/user/1000      

=============================================================================================================================
系统信息报告结束
=============================================================================================================================
```

## 3.二进制文件构建

- 此代码文件不建议进行构建可执行文件使用，针对环境版本的不同可执行文件灵活性比较差。